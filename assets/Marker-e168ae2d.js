import{j as i}from"./jsx-runtime-50395f49.js";import{r}from"./index-9fa1aa67.js";import{r as ne}from"./index-5b53e37f.js";import{b as ie,t as F,c as oe,f as M,F as D}from"./Map-415eb6e1.js";import{C as m}from"./CalloutContainer-d701ef6f.js";function ve({latitude:g,longitude:h,title:O="",subtitle:K="",accessibilityLabel:V=null,subtitleVisibility:x=D.Adaptive,titleVisibility:k=D.Adaptive,clusteringIdentifier:S=null,displayPriority:p=void 0,collisionMode:E=void 0,color:W="#ff5b40",glyphColor:q="white",glyphText:z="",glyphImage:G=null,selectedGlyphImage:H=null,paddingTop:y=0,paddingRight:j=0,paddingBottom:A=0,paddingLeft:C=0,anchorOffsetX:R=0,anchorOffsetY:b=0,calloutElement:o=void 0,calloutContent:a=void 0,calloutLeftAccessory:u=void 0,calloutRightAccessory:l=void 0,calloutEnabled:I=void 0,calloutOffsetX:P=0,calloutOffsetY:w=0,selected:J=!1,animates:L=!0,appearanceAnimation:Q="",visible:U=!0,draggable:Z=!1,enabled:_=!0,onSelect:$=void 0,onDeselect:B=void 0,onDragStart:N=void 0,onDragEnd:T=void 0,onDragging:X=void 0}){const[e,Y]=r.useState(null),s=r.useContext(ie);r.useEffect(()=>{e&&(e.subtitleVisibility=F(x))},[e,x]),r.useEffect(()=>{e&&(e.titleVisibility=F(k))},[e,k]),r.useEffect(()=>{e&&(e.padding=new mapkit.Padding(y,j,A,C))},[e,y,j,A,C]),r.useEffect(()=>{e&&(e.anchorOffset=new DOMPoint(R,b))},[e,R,b]),r.useEffect(()=>{e&&(e.calloutOffset=new DOMPoint(P,w))},[e,P,w]);const d=r.useRef(null),f=r.useRef(null),c=r.useRef(null),v=r.useRef(null);r.useLayoutEffect(()=>{if(!e)return;const t={};return o&&v.current!==null&&(t.calloutElementForAnnotation=()=>v.current),u&&d.current!==null&&(t.calloutLeftAccessoryForAnnotation=()=>d.current),l&&f.current!==null&&(t.calloutRightAccessoryForAnnotation=()=>f.current),a&&c.current!==null&&(t.calloutContentForAnnotation=()=>c.current),Object.keys(t).length>0?e.callout=t:delete e.callout,()=>{delete e.callout}},[e,o,u,l,a,v.current,d.current,f.current,c.current]),r.useEffect(()=>{e&&(E==="Circle"?e.collisionMode=mapkit.Annotation.CollisionMode.Circle:E==="Rectangle"?e.collisionMode=mapkit.Annotation.CollisionMode.Rectangle:delete e.collisionMode)},[e,E]),r.useEffect(()=>{if(e){if(p===void 0){delete e.displayPriority;return}e.displayPriority=oe(p)}},[e,p]),Object.entries({title:O,subtitle:K,accessibilityLabel:V,color:W,glyphColor:q,glyphText:z,glyphImage:G,selectedGlyphImage:H,clusteringIdentifier:S,selected:J,animates:L,appearanceAnimation:Q,draggable:Z,enabled:_,visible:U,calloutEnabled:I}).forEach(([t,n])=>{r.useEffect(()=>{if(e){if(n===void 0){delete e[t];return}e[t]=n}},[e,n])});const ee=()=>{};[{name:"select",handler:$},{name:"deselect",handler:B},{name:"drag-start",handler:N}].forEach(({name:t,handler:n})=>{M(e,t,n,ee)});const te=()=>({latitude:e.coordinate.latitude,longitude:e.coordinate.longitude}),re=t=>({latitude:t.coordinate.latitude,longitude:t.coordinate.longitude});return M(e,"drag-end",T,te),M(e,"dragging",X,re),r.useLayoutEffect(()=>{if(s===null)return;const t=new mapkit.MarkerAnnotation(new mapkit.Coordinate(g,h));return s.addAnnotation(t),Y(t),()=>{s.removeAnnotation(t)}},[s,g,h]),ne.createPortal(i.jsxs("div",{style:{display:"none"},children:[a!==void 0&&i.jsx(m,{ref:c,type:"content",children:a}),u!==void 0&&i.jsx(m,{ref:d,type:"left",children:u}),l!==void 0&&i.jsx(m,{ref:f,type:"right",children:l}),o!==void 0&&i.jsx(m,{ref:v,type:"container",children:o})]}),document.body)}export{ve as M};
